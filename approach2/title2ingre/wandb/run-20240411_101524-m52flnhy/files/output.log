


































































































  0%|          | 1513/302600 [03:19<10:13:08,  8.18it/s][INFO|trainer.py:765] 2024-04-11 10:18:48,023 >> The following columns in the evaluation set don't have a corresponding argument in `DebertaV2ForSequenceClassification.forward` and have been ignored: images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions. If images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions are not expected by `DebertaV2ForSequenceClassification.forward`,  you can safely ignore this message.
[INFO|trainer.py:3512] 2024-04-11 10:18:48,027 >> ***** Running Evaluation *****
[INFO|trainer.py:3514] 2024-04-11 10:18:48,027 >>   Num examples = 6049
[INFO|trainer.py:3517] 2024-04-11 10:18:48,027 >>   Batch size = 8
  7%|▋         | 56/757 [00:00<00:12, 57.96it/s]






  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
  0%|          | 1513/302600 [03:33<10:13:08,  8.[INFO|trainer.py:3203] 2024-04-11 10:19:02,153 >> Saving model checkpoint to /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-1513
[INFO|configuration_utils.py:471] 2024-04-11 10:19:02,157 >> Configuration saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-1513/config.json
[INFO|modeling_utils.py:2474] 2024-04-11 10:19:03,025 >> Model weights saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-1513/model.safetensors
[INFO|tokenization_utils_base.py:2502] 2024-04-11 10:19:03,027 >> tokenizer config file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-1513/tokenizer_config.json
[INFO|tokenization_utils_base.py:2511] 2024-04-11 10:19:03,027 >> Special tokens file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-1513/special_tokens_map.json
{'eval_loss': 0.058598849922418594, 'eval_accuracy': 0.00016531658125309968, 'eval_macro_f1': 0.0015282862643775624, 'eval_macro_precision': 0.0011512045567261305, 'eval_macro_recall': 0.0022727272727272726, 'eval_micro_f1': 0.11381660816106684, 'eval_micro_precision': 0.5065300049594974, 'eval_micro_recall': 0.06411114830934048, 'eval_combined_score': 0.09851075658642697, 'eval_runtime': 14.1244, 'eval_samples_per_second': 428.266, 'eval_steps_per_second': 53.595, 'epoch': 1.0}

































































































  1%|          | 3018/302600 [06:52<10:51:35,  7.66it/s]
  1%|          | 3026/302600 [06:53<10:56:22,  7.61it/s][INFO|trainer.py:765] 2024-04-11 10:22:22,112 >> The following columns in the evaluation set don't have a corresponding argument in `DebertaV2ForSequenceClassification.forward` and have been ignored: images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions. If images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions are not expected by `DebertaV2ForSequenceClassification.forward`,  you can safely ignore this message.
[INFO|trainer.py:3512] 2024-04-11 10:22:22,115 >> ***** Running Evaluation *****
[INFO|trainer.py:3514] 2024-04-11 10:22:22,115 >>   Num examples = 6049
[INFO|trainer.py:3517] 2024-04-11 10:22:22,115 >>   Batch size = 8






  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
{'eval_loss': 0.058547861874103546, 'eval_accuracy': 0.00016531658125309968, 'eval_macro_f1': 0.0015282862643775624, 'eval_macro_precision': 0.0011512045567261305, 'eval_macro_recall': 0.0022727272727272726, 'eval_micro_f1': 0.11381660816106684, 'eval_micro_precision': 0.5065300049594974, 'eval_micro_recall': 0.06411114830934048, 'eval_combined_score': 0.09851075658642697, 'eval_runtime': 13.8653, 'eval_samples_per_second': 436.268, 'eval_steps_per_second': 54.597, 'epoch': 2.0}
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
  1%|          | 3026/302600 [07:07<10:56:22,  7.[INFO|trainer.py:3203] 2024-04-11 10:22:35,982 >> Saving model checkpoint to /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-3026
[INFO|configuration_utils.py:471] 2024-04-11 10:22:35,986 >> Configuration saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-3026/config.json
[INFO|modeling_utils.py:2474] 2024-04-11 10:22:37,265 >> Model weights saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-3026/model.safetensors
[INFO|tokenization_utils_base.py:2502] 2024-04-11 10:22:37,267 >> tokenizer config file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-3026/tokenizer_config.json
[INFO|tokenization_utils_base.py:2511] 2024-04-11 10:22:37,267 >> Special tokens file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-3026/special_tokens_map.json

































































































  1%|▏         | 4537/302600 [10:27<10:31:14,  7.87it/s]
  2%|▏         | 4539/302600 [10:27<10:27:36,  7.92it/s][INFO|trainer.py:765] 2024-04-11 10:25:55,968 >> The following columns in the evaluation set don't have a corresponding argument in `DebertaV2ForSequenceClassification.forward` and have been ignored: images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions. If images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions are not expected by `DebertaV2ForSequenceClassification.forward`,  you can safely ignore this message.
[INFO|trainer.py:3512] 2024-04-11 10:25:55,978 >> ***** Running Evaluation *****
[INFO|trainer.py:3514] 2024-04-11 10:25:55,979 >>   Num examples = 6049
[INFO|trainer.py:3517] 2024-04-11 10:25:55,979 >>   Batch size = 8





  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
{'eval_loss': 0.05842938274145126, 'eval_accuracy': 0.0, 'eval_macro_f1': 0.0, 'eval_macro_precision': 0.0, 'eval_macro_recall': 0.0, 'eval_micro_f1': 0.0, 'eval_micro_precision': 0.0, 'eval_micro_recall': 0.0, 'eval_combined_score': 0.0, 'eval_runtime': 14.1265, 'eval_samples_per_second': 428.203, 'eval_steps_per_second': 53.587, 'epoch': 3.0}
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
  2%|▏         | 4539/302600 [10:41<10:27:36,  7.[INFO|trainer.py:3203] 2024-04-11 10:26:10,111 >> Saving model checkpoint to /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-4539
[INFO|configuration_utils.py:471] 2024-04-11 10:26:10,118 >> Configuration saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-4539/config.json
[INFO|modeling_utils.py:2474] 2024-04-11 10:26:11,096 >> Model weights saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-4539/model.safetensors
[INFO|tokenization_utils_base.py:2502] 2024-04-11 10:26:11,099 >> tokenizer config file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-4539/tokenizer_config.json
[INFO|tokenization_utils_base.py:2511] 2024-04-11 10:26:11,099 >> Special tokens file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-4539/special_tokens_map.json

































































































  2%|▏         | 6052/302600 [14:00<10:55:40,  7.54it/s][INFO|trainer.py:765] 2024-04-11 10:29:29,655 >> The following columns in the evaluation set don't have a corresponding argument in `DebertaV2ForSequenceClassification.forward` and have been ignored: images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions. If images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions are not expected by `DebertaV2ForSequenceClassification.forward`,  you can safely ignore this message.
[INFO|trainer.py:3512] 2024-04-11 10:29:29,660 >> ***** Running Evaluation *****
[INFO|trainer.py:3514] 2024-04-11 10:29:29,660 >>   Num examples = 6049
[INFO|trainer.py:3517] 2024-04-11 10:29:29,661 >>   Batch size = 8
  2%|▏         | 15/757 [00:00<00:11, 63.67it/s]






  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
  2%|▏         | 6052/302600 [14:14<10:55:40,  7.[INFO|trainer.py:3203] 2024-04-11 10:29:43,555 >> Saving model checkpoint to /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-6052
[INFO|configuration_utils.py:471] 2024-04-11 10:29:43,558 >> Configuration saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-6052/config.json
{'eval_loss': 0.05830293893814087, 'eval_accuracy': 0.0, 'eval_macro_f1': 0.0, 'eval_macro_precision': 0.0, 'eval_macro_recall': 0.0, 'eval_micro_f1': 0.0, 'eval_micro_precision': 0.0, 'eval_micro_recall': 0.0, 'eval_combined_score': 0.0, 'eval_runtime': 13.8928, 'eval_samples_per_second': 435.406, 'eval_steps_per_second': 54.489, 'epoch': 4.0}
[INFO|modeling_utils.py:2474] 2024-04-11 10:29:44,297 >> Model weights saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-6052/model.safetensors
[INFO|tokenization_utils_base.py:2502] 2024-04-11 10:29:44,298 >> tokenizer config file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-6052/tokenizer_config.json
[INFO|tokenization_utils_base.py:2511] 2024-04-11 10:29:44,298 >> Special tokens file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-6052/special_tokens_map.json

































































































  2%|▏         | 7560/302600 [17:33<10:40:37,  7.68it/s]
  2%|▎         | 7565/302600 [17:33<10:46:11,  7.61it/s][INFO|trainer.py:765] 2024-04-11 10:33:02,677 >> The following columns in the evaluation set don't have a corresponding argument in `DebertaV2ForSequenceClassification.forward` and have been ignored: images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions. If images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions are not expected by `DebertaV2ForSequenceClassification.forward`,  you can safely ignore this message.
[INFO|trainer.py:3512] 2024-04-11 10:33:02,681 >> ***** Running Evaluation *****
[INFO|trainer.py:3514] 2024-04-11 10:33:02,681 >>   Num examples = 6049
[INFO|trainer.py:3517] 2024-04-11 10:33:02,681 >>   Batch size = 8





  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
{'eval_loss': 0.05836022272706032, 'eval_accuracy': 0.00016531658125309968, 'eval_macro_f1': 0.0015282862643775624, 'eval_macro_precision': 0.0011512045567261305, 'eval_macro_recall': 0.0022727272727272726, 'eval_micro_f1': 0.11381660816106684, 'eval_micro_precision': 0.5065300049594974, 'eval_micro_recall': 0.06411114830934048, 'eval_combined_score': 0.09851075658642697, 'eval_runtime': 13.8816, 'eval_samples_per_second': 435.756, 'eval_steps_per_second': 54.532, 'epoch': 5.0}
  2%|▎         | 7565/302600 [17:47<10:46:11,  7.[INFO|trainer.py:3203] 2024-04-11 10:33:16,566 >> Saving model checkpoint to /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-7565
[INFO|configuration_utils.py:471] 2024-04-11 10:33:16,570 >> Configuration saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-7565/config.json
[INFO|modeling_utils.py:2474] 2024-04-11 10:33:17,312 >> Model weights saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-7565/model.safetensors
[INFO|tokenization_utils_base.py:2502] 2024-04-11 10:33:17,313 >> tokenizer config file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-7565/tokenizer_config.json
[INFO|tokenization_utils_base.py:2511] 2024-04-11 10:33:17,313 >> Special tokens file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-7565/special_tokens_map.json

































































































  3%|▎         | 9078/302600 [21:06<10:21:57,  7.87it/s][INFO|trainer.py:765] 2024-04-11 10:36:35,720 >> The following columns in the evaluation set don't have a corresponding argument in `DebertaV2ForSequenceClassification.forward` and have been ignored: images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions. If images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions are not expected by `DebertaV2ForSequenceClassification.forward`,  you can safely ignore this message.
[INFO|trainer.py:3512] 2024-04-11 10:36:35,723 >> ***** Running Evaluation *****
[INFO|trainer.py:3514] 2024-04-11 10:36:35,724 >>   Num examples = 6049
[INFO|trainer.py:3517] 2024-04-11 10:36:35,724 >>   Batch size = 8
  8%|▊         | 57/757 [00:00<00:11, 60.81it/s]






  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
  3%|▎         | 9078/302600 [21:20<10:21:57,  7.[INFO|trainer.py:3203] 2024-04-11 10:36:49,526 >> Saving model checkpoint to /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-9078
[INFO|configuration_utils.py:471] 2024-04-11 10:36:49,529 >> Configuration saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-9078/config.json
[INFO|modeling_utils.py:2474] 2024-04-11 10:36:50,255 >> Model weights saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-9078/model.safetensors
[INFO|tokenization_utils_base.py:2502] 2024-04-11 10:36:50,256 >> tokenizer config file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-9078/tokenizer_config.json
[INFO|tokenization_utils_base.py:2511] 2024-04-11 10:36:50,256 >> Special tokens file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-9078/special_tokens_map.json
{'eval_loss': 0.05838225781917572, 'eval_accuracy': 0.00016531658125309968, 'eval_macro_f1': 0.0015282862643775624, 'eval_macro_precision': 0.0011512045567261305, 'eval_macro_recall': 0.0022727272727272726, 'eval_micro_f1': 0.11381660816106684, 'eval_micro_precision': 0.5065300049594974, 'eval_micro_recall': 0.06411114830934048, 'eval_combined_score': 0.09851075658642697, 'eval_runtime': 13.8, 'eval_samples_per_second': 438.333, 'eval_steps_per_second': 54.855, 'epoch': 6.0}

































































































  4%|▎         | 10591/302600 [24:39<10:22:31,  7.82it/s][INFO|trainer.py:765] 2024-04-11 10:40:08,442 >> The following columns in the evaluation set don't have a corresponding argument in `DebertaV2ForSequenceClassification.forward` and have been ignored: images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions. If images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions are not expected by `DebertaV2ForSequenceClassification.forward`,  you can safely ignore this message.
[INFO|trainer.py:3512] 2024-04-11 10:40:08,446 >> ***** Running Evaluation *****
[INFO|trainer.py:3514] 2024-04-11 10:40:08,446 >>   Num examples = 6049
[INFO|trainer.py:3517] 2024-04-11 10:40:08,446 >>   Batch size = 8
  3%|▎         | 22/757 [00:00<00:11, 62.06it/s]






  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
  4%|▎         | 10591/302600 [24:53<10:22:31,  7[INFO|trainer.py:3203] 2024-04-11 10:40:22,262 >> Saving model checkpoint to /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-10591
[INFO|configuration_utils.py:471] 2024-04-11 10:40:22,265 >> Configuration saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-10591/config.json
{'eval_loss': 0.058344122022390366, 'eval_accuracy': 0.00016531658125309968, 'eval_macro_f1': 0.0015282862643775624, 'eval_macro_precision': 0.0011512045567261305, 'eval_macro_recall': 0.0022727272727272726, 'eval_micro_f1': 0.11381660816106684, 'eval_micro_precision': 0.5065300049594974, 'eval_micro_recall': 0.06411114830934048, 'eval_combined_score': 0.09851075658642697, 'eval_runtime': 13.8133, 'eval_samples_per_second': 437.91, 'eval_steps_per_second': 54.802, 'epoch': 7.0}
[INFO|modeling_utils.py:2474] 2024-04-11 10:40:22,989 >> Model weights saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-10591/model.safetensors
[INFO|tokenization_utils_base.py:2502] 2024-04-11 10:40:22,991 >> tokenizer config file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-10591/tokenizer_config.json
[INFO|tokenization_utils_base.py:2511] 2024-04-11 10:40:22,991 >> Special tokens file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-10591/special_tokens_map.json
[INFO|trainer.py:2231] 2024-04-11 10:40:24,645 >>
Training completed. Do not forget to share your model on huggingface.co/models =)
[INFO|trainer.py:2436] 2024-04-11 10:40:24,645 >> Loading best model from /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/checkpoint-6052 (score: 0.05830293893814087).
  4%|▎         | 10591/302600 [24:56<11:27:28,  7.08it/s]
[INFO|trainer.py:3203] 2024-04-11 10:40:24,811 >> Saving model checkpoint to /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5
[INFO|configuration_utils.py:471] 2024-04-11 10:40:24,813 >> Configuration saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/config.json
{'train_runtime': 1501.5989, 'train_samples_per_second': 6444.863, 'train_steps_per_second': 201.519, 'train_loss': 0.05979756774988788, 'epoch': 7.0}
***** train metrics *****
  epoch                    =        7.0
  train_loss               =     0.0598
  train_runtime            = 0:25:01.59
  train_samples            =      48388
  train_samples_per_second =   6444.863
  train_steps_per_second   =    201.519
04/11/2024 10:40:25 - INFO - __main__ - *** Evaluate ***
[INFO|modeling_utils.py:2474] 2024-04-11 10:40:25,618 >> Model weights saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/model.safetensors
[INFO|tokenization_utils_base.py:2502] 2024-04-11 10:40:25,619 >> tokenizer config file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/tokenizer_config.json
[INFO|tokenization_utils_base.py:2511] 2024-04-11 10:40:25,619 >> Special tokens file saved in /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/special_tokens_map.json
[INFO|trainer.py:765] 2024-04-11 10:40:25,648 >> The following columns in the evaluation set don't have a corresponding argument in `DebertaV2ForSequenceClassification.forward` and have been ignored: images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions. If images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions are not expected by `DebertaV2ForSequenceClassification.forward`,  you can safely ignore this message.
[INFO|trainer.py:3512] 2024-04-11 10:40:25,650 >> ***** Running Evaluation *****
[INFO|trainer.py:3514] 2024-04-11 10:40:25,651 >>   Num examples = 6049
[INFO|trainer.py:3517] 2024-04-11 10:40:25,651 >>   Batch size = 8





100%|█████████▉| 756/757 [00:12<00:00, 60.96it/s]/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
***** eval metrics *****
  epoch                   =        7.0
  eval_accuracy           =        0.0
  eval_combined_score     =        0.0
  eval_loss               =     0.0583
  eval_macro_f1           =        0.0
  eval_macro_precision    =        0.0
  eval_macro_recall       =        0.0
  eval_micro_f1           =        0.0
  eval_micro_precision    =        0.0
  eval_micro_recall       =        0.0
  eval_runtime            = 0:00:13.83
  eval_samples            =       6049
  eval_samples_per_second =    437.287
  eval_steps_per_second   =     54.724
04/11/2024 10:40:39 - INFO - __main__ - *** Predict ***
/local/xiaowang/miniconda3/envs/food_ingre/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1509: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
100%|██████████| 757/757 [00:13<00:00, 54.81it/s]
[INFO|trainer.py:765] 2024-04-11 10:40:39,488 >> The following columns in the test set don't have a corresponding argument in `DebertaV2ForSequenceClassification.forward` and have been ignored: images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions. If images, url, sentence, ingredients, generated_intro, extracted_ingredients, partition, image_file_name_ls, title, id, instructions are not expected by `DebertaV2ForSequenceClassification.forward`,  you can safely ignore this message.
[INFO|trainer.py:3512] 2024-04-11 10:40:39,490 >> ***** Running Prediction *****
[INFO|trainer.py:3514] 2024-04-11 10:40:39,490 >>   Num examples = 6048
[INFO|trainer.py:3517] 2024-04-11 10:40:39,490 >>   Batch size = 8




100%|██████████| 756/756 [00:10<00:00, 70.40it/s]
[INFO|modelcard.py:450] 2024-04-11 10:40:50,853 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Text Classification', 'type': 'text-classification'}, 'metrics': [{'name': 'Accuracy', 'type': 'accuracy', 'value': 0.0}]}
04/11/2024 10:40:50 - INFO - __main__ - ***** Predict results *****
04/11/2024 10:40:50 - INFO - __main__ - Predict results saved at /local/xiaowang/food_ingredient/saved_models/approach2/text_classification_generated_lr5/microsoft_deberta-v3-base_predict_results.txt